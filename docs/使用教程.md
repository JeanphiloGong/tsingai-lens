# 使用教程（前端页面：frontend/src/routes/+page.svelte）

本文面向需要手动体验 GraphRAG 文件上传、列表、详情、图谱问答的用户，说明如何在现有前端页面完成基本操作。

## 环境准备
- 确保后端启动并可访问（默认 http://localhost:8010，或在前端根目录创建 `.env` 配置 `PUBLIC_API_BASE` 指向后端，例如 `cp .env.example .env` 后修改地址）。
- 安装前端依赖：`cd frontend && npm install`。
- 启动前端开发服务器：`npm run dev -- --open`。页面根路由即 `+page.svelte` 的 UI。

## 页面概览
进入页面后顶部展示健康状态与文档数量统计，左侧为上传与列表，右侧为问答与详情/图谱。

### 1) 健康检查
- 页面加载即调用 `GET /graph/health`，状态徽章显示为 ok/healthy/未知/异常。若为 down，请先检查后端服务与 `PUBLIC_API_BASE` 配置。

### 2) 上传文件
- 面板“上传文件”对应 `POST /file/upload`，支持 PDF/MD/TXT/DOCX/CSV。
- 操作步骤：选择文件 → 可选填写 `标签`（逗号分隔）与 `元数据`（需合法 JSON 字符串，否则会提示“元数据需合法 JSON”）→ 点击“上传并入图”。
- 上传后页面自动轮询 `GET /file/status/{id}`，在提示区显示当前状态及消息；最近一次的文档 ID 会记录在“最新文档 ID”。

### 3) 文档列表
- 对应 `GET /graph/documents`。支持文件名/标签搜索与状态筛选（成功、处理中、待处理、失败）。
- “刷新列表”重新拉取数据；每个条目显示文件名、状态提示、标签与更新时间。
- 点击条目会在右侧加载该文档详情。

### 4) 图谱问答
- 对应 `POST /chat/query`。输入问题后可选择模式（`optimize`/`precision`/`recall`），调节 `top_k_cards`（默认 5）与 `max_edges`（默认 80），然后点击“运行问答/发送”。
- 返回结果展示回答及溯源 Sources（文档 ID、片段、页码、关系、得分）。点击 Source 上的“激活图谱: {docId}”按钮会切换到该文档的图谱视图。

### 5) 文档详情与图谱
- 详情区域包含四个标签页：
  - `summary`：显示摘要（`meta.summary`）。
  - `keywords`：来自 `GET /graph/documents/{id}/keywords`。
  - `info`：显示 `meta.info` 或上传时的 `metadata` 原始 JSON。
  - `graph`：展示图谱/脑图（`GET /graph/documents/{id}/graph`）。节点按类型/索引着色，可点击或按回车/空格聚焦节点，显示节点数与边数统计；若无图数据，会回退展示原始 JSON 片段，同时若含 `mindmap` 也会以 JSON 形式附带显示。
- “刷新状态”按钮会重新查询 `GET /file/status/{selectedId}` 并同步列表中的状态。

## 推荐使用流程
1. 启动后端与前端，确认健康状态为 ok/healthy。
2. 上传文件并等待状态变为 succeeded（可在提示区或列表中查看进度）。
3. 在列表中选中该文档，查看摘要/关键词/Info/图谱。
4. 在“图谱问答”输入问题，选择模式后运行，结合回答与 Sources，并可点击激活图谱查看关联节点。
